<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <title>Laporan Penjualan - Cookie Craft</title>
    <!-- Library Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div layout:fragment="content">
    <div class="text-center mb-5">
        <h2 class="fw-bold" style="color: #5D4037;">ðŸ“Š Laporan Penjualan</h2>
        <p class="text-muted">Grafik jumlah kue yang telah terjual</p>
    </div>

    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card border-0 shadow-sm rounded-4 p-4">
                <canvas id="salesChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Mengambil data dari Backend
            fetch('/cookies/api/chart-data')
                .then(response => response.json())
                .then(data => {
                    const ctx = document.getElementById('salesChart').getContext('2d');
                    new Chart(ctx, {
                        type: 'bar', // Tipe grafik batang
                        data: {
                            labels: data.labels, // Nama-nama kue
                            datasets: [{
                                label: 'Jumlah Terjual (pcs)',
                                data: data.data, // Jumlah terjual
                                backgroundColor: 'rgba(216, 27, 96, 0.6)', /* Pink */
                                borderColor: 'rgba(216, 27, 96, 1)',
                                borderWidth: 1,
                                borderRadius: 10
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: { display: false }
                            },
                            scales: {
                                y: { beginAtZero: true }
                            }
                        }
                    });
                })
                .catch(error => console.error('Error fetching chart data:', error));
        });
    </script>
</div>
</body>
</html>