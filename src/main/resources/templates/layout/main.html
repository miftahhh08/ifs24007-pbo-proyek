<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yummy Market</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    
    <!-- Google Fonts (Fredoka & Nunito - Kunci tampilan Imut!) -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #FF6B6B; /* Soft Coral / Merah Semangka */
            --secondary-color: #FFD93D; /* Kuning Telur */
            --bg-color: #FFF5F3; /* Pink Sangat Muda (Hampir Putih) */
            --text-color: #4E342E; /* Coklat Tua (Lebih lembut dari Hitam) */
            --glass-bg: rgba(255, 255, 255, 0.85);
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, .navbar-brand, .btn {
            font-family: 'Fredoka', sans-serif; /* Font Judul Bulat */
        }

        /* --- NAVBAR LUCU --- */
        .navbar-yummy {
            background-color: var(--primary-color);
            box-shadow: 0 4px 20px rgba(255, 107, 107, 0.2);
            border-bottom-left-radius: 25px;
            border-bottom-right-radius: 25px;
            padding: 15px 0;
        }

        .navbar-brand {
            font-size: 1.8rem;
            color: white !important;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.9) !important;
            font-weight: 600;
            transition: transform 0.2s;
        }
        .nav-link:hover {
            transform: scale(1.1);
            color: #fff !important;
        }

        /* --- ANIMASI MAKANAN JATUH --- */
        #food-rain {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: -1;
            overflow: hidden;
        }
        .falling-food {
            position: absolute;
            top: -50px;
            font-size: 24px;
            opacity: 0.4; /* Transparan biar ga norak */
            animation: fall linear infinite;
        }
        @keyframes fall {
            to { transform: translateY(110vh) rotate(360deg); }
        }

        /* --- TOMBOL GEMOY --- */
        .btn-yummy {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }
        .btn-yummy:hover {
            background-color: #ff5252;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(255, 107, 107, 0.3);
        }
        .btn-yummy:active { transform: scale(0.95); }

        /* Card Style */
        .card-custom {
            border: none;
            border-radius: 25px;
            background: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            overflow: hidden;
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">

    <!-- Animasi Background -->
    <div id="food-rain"></div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-yummy sticky-top">
        <div class="container">
            <a class="navbar-brand" th:href="@{/}">
                <i class="bi bi-basket2-fill me-2 text-warning"></i>Yummy Market
            </a>
            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <i class="bi bi-list text-white fs-2"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    
                    <!-- Menu Belanja -->
                    <li class="nav-item me-2">
                        <a class="nav-link" th:href="@{/shop}">
                            <i class="bi bi-shop me-1"></i> Belanja
                        </a>
                    </li>

                    <!-- LOGIKA TOMBOL TOKO -->
                    <!-- Jika Admin -->
                    <li class="nav-item" th:if="${user != null and user.role == 'ADMIN'}">
                        <a class="btn btn-light text-danger fw-bold rounded-pill px-3 shadow-sm" th:href="@{/cookies}">
                            <i class="bi bi-speedometer2 me-1"></i> Dashboard Toko
                        </a>
                    </li>

                    <!-- Jika Pembeli (Tombol Buka Toko) -->
                    <li class="nav-item" th:if="${user != null and user.role == 'BUYER'}">
                        <form th:action="@{/auth/become-seller}" method="post" class="d-inline">
                            <button type="submit" class="btn btn-warning text-dark fw-bold rounded-pill px-3 shadow-sm" 
                                    onclick="return confirm('Siap jadi juragan makanan? üç≥')">
                                <i class="bi bi-shop-window me-1"></i> Buka Toko Gratis
                            </button>
                        </form>
                    </li>

                    <!-- Logout -->
                    <li class="nav-item ms-3" th:if="${user != null}">
                        <a th:href="@{/auth/logout}" class="nav-link text-white opacity-75" title="Keluar">
                            <i class="bi bi-box-arrow-right fs-5"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Content -->
    <main class="container py-5 flex-grow-1">
        <div layout:fragment="content"></div>
    </main>

    <!-- Footer -->
    <footer class="py-4 text-center text-muted" style="background-color: #fff;">
        <small>Made with <i class="bi bi-heart-fill text-danger"></i> by Yummy Market &copy; 2025</small>
    </footer>

    <!-- Script Animasi Makanan -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('food-rain');
            const foods = ['üçî','üçï','üç©','üç¶','ü•ó','üçâ','ü•ë','ü•ê','üçø','üçì'];
            
            for(let i=0; i<25; i++) {
                const el = document.createElement('div');
                el.classList.add('falling-food');
                el.innerText = foods[Math.floor(Math.random() * foods.length)];
                el.style.left = Math.random() * 100 + 'vw';
                el.style.animationDuration = (Math.random() * 5 + 5) + 's';
                el.style.animationDelay = Math.random() * 5 + 's';
                el.style.fontSize = (Math.random() * 20 + 20) + 'px';
                container.appendChild(el);
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>